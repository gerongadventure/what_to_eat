<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä»Šå¤©åƒä»€ä¹ˆå¤§é€ƒæ€</title>
    <link rel="manifest" href="manifest.json">
    <style>
        /* --- åŸºç¡€æ ·å¼ --- */
        :root { --bg: #fdf6ec; --primary: #ff9a9e; }
        body { background: var(--bg); font-family: sans-serif; text-align: center; padding: 20px; }
        h1 { color: var(--primary); }
        .arena { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; max-width: 600px; margin: 0 auto 80px auto; }
        
        .card {
            background: #fff; border-radius: 12px; padding: 15px 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); font-weight: bold;
            transition: transform 0.3s; cursor: pointer; position: relative;
        }

        /* --- âœ¨ éšæœºæ¶ˆå¤±ç‰¹æ•ˆåº“ âœ¨ --- */
        
        /* ç‰¹æ•ˆ1: ç‚¸é£ (å‘å„ä¸ªæ–¹å‘ç‚¸è£‚å¹¶æ¶ˆå¤±) */
        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5) rotate(15deg); opacity: 0.8; filter: contrast(200%); }
            100% { transform: scale(2); opacity: 0; filter: blur(10px); }
        }
        .fx-explode { animation: explode 0.5s forwards; }

        /* ç‰¹æ•ˆ2: æ‰è½æ·±æ¸Š (å‘ä¸‹æ‰è½å¹¶å˜é€æ˜) */
        @keyframes dropDown {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(100px) rotate(-20deg); opacity: 0; }
        }
        .fx-drop { animation: dropDown 0.6s forwards; }

        /* ç‰¹æ•ˆ3: ç”šè‡³æ²¡æ¥å¾—åŠå‘Šåˆ« (åƒç´ åŒ–æ”¶ç¼©) */
        @keyframes shrink {
            0% { transform: scale(1); }
            100% { transform: scale(0); opacity: 0; }
        }
        .fx-shrink { animation: shrink 0.4s ease-in forwards; }

        /* ç‰¹æ•ˆ4: çµé­‚å‡ºçª (å‘ä¸Šé£˜èµ°) */
        @keyframes ghost {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; filter: grayscale(100%); }
        }
        .fx-ghost { animation: ghost 0.8s ease-out forwards; }

        /* èµ¢å®¶æ ·å¼ */
        .winner { transform: scale(1.3) !important; border: 3px solid var(--primary); z-index: 10; background: #fff5f5; }

        /* æŒ‰é’® */
        button {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            padding: 15px 40px; border-radius: 50px; border: none;
            background: var(--primary); color: white; font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
        }
    </style>
</head>
<body>
    <h1>ğŸ”ª ç¾é£Ÿå¤§é€ƒæ€</h1>
    <div class="arena" id="arena">Loading...</div>
    <button onclick="startBattle()" id="btn">å¼€å§‹å¤„åˆ‘</button>

    <script>
        let cards = [];
        const effects = ['fx-explode', 'fx-drop', 'fx-shrink', 'fx-ghost']; // ç‰¹æ•ˆæ± 

        // 1. è¯»å–å¤–éƒ¨ JSON æ–‡ä»¶
        async function loadData() {
            try {
                // æ³¨æ„ï¼šæœ¬åœ°ç›´æ¥åŒå‡» html æ‰“å¼€é€šå¸¸ä¼šæ‹¦æˆª fetchï¼Œéœ€è¦éƒ¨ç½²åæ‰èƒ½ç”Ÿæ•ˆï¼ˆè§ä¸‹æ–‡ï¼‰
                const response = await fetch('data.json'); 
                const data = await response.json();
                renderCards(data);
            } catch (error) {
                document.getElementById('arena').innerHTML = "âš ï¸ è¯·å°†æ–‡ä»¶éƒ¨ç½²åˆ°æœåŠ¡å™¨æˆ– GitHub Pages ä»¥åŠ è½½æ•°æ®";
                console.error(error);
            }
        }

        function renderCards(data) {
            const arena = document.getElementById('arena');
            arena.innerHTML = '';
            cards = [];
            data.forEach((item, i) => {
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `${item.icon} ${item.name}`;
                arena.appendChild(div);
                cards.push(div);
            });
        }

        // 2. éšæœºç‰¹æ•ˆé€»è¾‘
        function startBattle() {
            const btn = document.getElementById('btn');
            btn.disabled = true;
            // é‡æ–°åŠ è½½æ•°æ®ï¼ˆä¸ºäº†é‡ç½®æ ·å¼ï¼‰
            const aliveCards = Array.from(document.querySelectorAll('.card'));
            
            // é€’å½’æ·˜æ±°
            let speed = 200;
            function killOne() {
                if (aliveCards.length === 1) {
                    aliveCards[0].classList.add('winner');
                    btn.innerText = "å†³å®šæ˜¯ä½ äº†ï¼";
                    btn.disabled = false;
                    return;
                }

                // éšæœºé€‰ä¸€ä¸ªå€’éœ‰è›‹
                const rIndex = Math.floor(Math.random() * aliveCards.length);
                const victim = aliveCards[rIndex];
                
                // éšæœºé€‰ä¸€ç§æ­»æ³•
                const rEffect = effects[Math.floor(Math.random() * effects.length)];
                victim.classList.add(rEffect);

                // ä»å­˜æ´»æ•°ç»„ç§»é™¤
                aliveCards.splice(rIndex, 1);

                // å‡é€Ÿé€»è¾‘
                speed += (cards.length - aliveCards.length) * 20;
                setTimeout(killOne, speed);
            }
            killOne();
        }

        loadData();
    </script>
</body>
</html>